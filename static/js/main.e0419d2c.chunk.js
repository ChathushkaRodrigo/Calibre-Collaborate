(this["webpackJsonpgraph-tutorial"]=this["webpackJsonpgraph-tutorial"]||[]).push([[0],{142:function(e,t,a){},161:function(e,t,a){},162:function(e,t,a){},164:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(61),i=a.n(c),s=a(124),o=a(13),l={appId:"544352e1-ab72-455c-afad-f2e10ca0f19c",redirectUri:"http://localhost:3000",scopes:["user.read","mailboxsettings.read","calendars.readwrite"]},d=(a(142),a(5)),u=a(58),j=a(29),b=a(172),m=a(45),v=a(6),O=a.n(v),h=a(39),x=a(27),p=a(125),f=a(3),g=a(118),y=a(170),w=a(171),N=a(179),C=void 0;function k(e){return C||(C=g.a.initWithMiddleware({authProvider:e})),C}function S(e){return F.apply(this,arguments)}function F(){return(F=Object(h.a)(O.a.mark((function e(t){var a;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(t),e.next=3,C.api("/me").select("displayName,mail,mailboxSettings,userPrincipalName").get();case 3:return a=e.sent,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function T(e,t){return E.apply(this,arguments)}function E(){return(E=Object(h.a)(O.a.mark((function e(t,a){var n,r,c,i,s,o,l;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(t),n=new Date,r=Object(N.a)(Object(y.a)(n),a).toISOString(),c=Object(N.a)(Object(w.a)(n),a).toISOString(),e.next=6,C.api("/me/calendarview").header("Prefer",'outlook.timezone="'.concat(a,'"')).query({startDateTime:r,endDateTime:c}).select("subject,organizer,start,end").orderby("start/dateTime").top(25).get();case 6:if(!(i=e.sent)["@odata.nextLink"]){e.next=16;break}return s=[],o={headers:{Prefer:'outlook.timezone="'.concat(a,'"')}},l=new g.b(C,i,(function(e){return s.push(e),!0}),o),e.next=13,l.iterate();case 13:return e.abrupt("return",s);case 16:return e.abrupt("return",i.value);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(e,t){return P.apply(this,arguments)}function P(){return(P=Object(h.a)(O.a.mark((function e(t,a){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(t),e.next=3,C.api("/me/events").post(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=a(2),M=Object(n.createContext)({user:void 0,error:void 0,signIn:void 0,signOut:void 0,displayError:void 0,clearError:void 0,authProvider:void 0});function L(){return Object(n.useContext)(M)}function D(e){var t=e.children,a=function(){var e=Object(n.useState)(void 0),t=Object(x.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(void 0),i=Object(x.a)(c,2),s=i[0],o=i[1],d=Object(m.d)(),u=function(e,t){o({message:e,debug:t})},j=function(){o(void 0)},b=new p.AuthCodeMSALBrowserAuthenticationProvider(d.instance,{account:d.instance.getActiveAccount(),scopes:l.scopes,interactionType:f.g.Popup});Object(n.useEffect)((function(){(function(){var e=Object(h.a)(O.a.mark((function e(){var t,n,c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=13;break}if(e.prev=1,!d.instance.getActiveAccount()){e.next=8;break}return e.next=6,S(b);case 6:c=e.sent,r({displayName:c.displayName||"",email:c.mail||c.userPrincipalName||"",timeFormat:(null===(t=c.mailboxSettings)||void 0===t?void 0:t.timeFormat)||"h:mm a",timeZone:(null===(n=c.mailboxSettings)||void 0===n?void 0:n.timeZone)||"UTC"});case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),u(e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}})()()}));var v=function(){var e=Object(h.a)(O.a.mark((function e(){var t,a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.instance.loginPopup({scopes:l.scopes,prompt:"select_account"});case 2:return e.next=4,S(b);case 4:n=e.sent,r({displayName:n.displayName||"",email:n.mail||n.userPrincipalName||"",timeFormat:(null===(t=n.mailboxSettings)||void 0===t?void 0:t.timeFormat)||"",timeZone:(null===(a=n.mailboxSettings)||void 0===a?void 0:a.timeZone)||"UTC"});case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return{user:a,error:s,signIn:v,signOut:function(){var e=Object(h.a)(O.a.mark((function e(){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d.instance.logoutPopup();case 2:r(void 0);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),displayError:u,clearError:j,authProvider:b}}();return Object(I.jsx)(M.Provider,{value:a,children:t})}var Z=a(181);function z(){var e=L();return e.error?Object(I.jsxs)(Z.a,{variant:"danger",dismissible:!0,onClose:function(){return e.clearError()},children:[Object(I.jsx)("p",{className:"mb-3",children:e.error.message}),e.error.debug?Object(I.jsx)("pre",{className:"alert-pre border bg-light p-2",children:Object(I.jsx)("code",{children:e.error.debug})}):null]}):null}var G=a(180),U=a(182),B=a(128),J=a(173),_=a(65);function W(e){return Object(I.jsx)("img",{src:e.user.avatar||"/images/no-profile-photo.png",alt:"user",className:"rounded-circle align-self-center mr-2",style:{width:"32px"}})}function q(){var e=L(),t=e.user||{displayName:"",email:""};return Object(I.jsx)(G.a,{bg:"dark",variant:"dark",expand:"md",fixed:"top",children:Object(I.jsxs)(b.a,{children:[Object(I.jsx)(G.a.Brand,{href:"/",children:"Calibre Collaborate"}),Object(I.jsx)(G.a.Toggle,{}),Object(I.jsxs)(G.a.Collapse,{children:[Object(I.jsxs)(U.a,{className:"me-auto",navbar:!0,children:[Object(I.jsx)(B.a,{children:Object(I.jsx)(u.b,{to:"/",className:"nav-link",exact:!0,children:"Home"})}),Object(I.jsx)(m.a,{children:Object(I.jsx)(B.a,{children:Object(I.jsx)(u.b,{to:"/calendar",className:"nav-link",exact:!0,children:"Calendar"})})})]}),Object(I.jsxs)(U.a,{className:"ms-auto align-items-center",navbar:!0,children:[Object(I.jsx)(B.a,{children:Object(I.jsx)(U.a.Link,{href:"https://developer.microsoft.com/graph/docs/concepts/overview",target:"_blank",children:"Docs"})}),Object(I.jsx)(m.a,{children:Object(I.jsxs)(J.a,{title:Object(I.jsx)(W,{user:t}),id:"user-dropdown",align:"end",children:[Object(I.jsx)("h5",{className:"dropdown-item-text mb-0",children:t.displayName}),Object(I.jsx)("p",{className:"dropdown-item-text text-muted mb-0",children:t.email}),Object(I.jsx)(_.a.Divider,{}),Object(I.jsx)(_.a.Item,{onClick:e.signOut,children:"Sign Out"})]})}),Object(I.jsx)(m.c,{children:Object(I.jsx)(B.a,{children:Object(I.jsx)(U.a.Link,{onClick:e.signIn,children:"Sign In"})})})]})]})]})})}var H=a(132);a(161);function K(e){var t,a=L();return Object(I.jsx)("div",{className:"p-5 mb-4  rounded-3",children:Object(I.jsxs)(b.a,{fluid:!0,children:[Object(I.jsx)("h1",{children:"Calibre Collaborate  "}),Object(I.jsx)("p",{className:"lead",children:"now lets get started on scheduling a meeting"}),Object(I.jsx)(m.a,{children:Object(I.jsxs)("div",{children:[Object(I.jsxs)("h4",{children:["Welcome ",(null===(t=a.user)||void 0===t?void 0:t.displayName)||"","!"]}),Object(I.jsx)("p",{})]})}),Object(I.jsx)(m.c,{children:Object(I.jsx)(H.a,{color:"primary",onClick:a.signIn,children:"Click here to sign in"})})]})})}var Q=a(175),R=a(133),V=a(135),X=a(176),Y=a(174),$=a(183),ee={"h:mm tt":"h:mm a","hh:mm tt":"hh:mm a"};function te(e,t){if(void 0!==e){var a=Object(Y.a)(e);return Object(V.a)(a,ee[t]||t)}}function ae(e){return Object(I.jsxs)("td",{className:"calendar-view-date-cell",rowSpan:e.events.length<=0?1:e.events.length,children:[Object(I.jsx)("div",{className:"calendar-view-date float-left text-right",children:Object(V.a)(e.date,"dd")}),Object(I.jsx)("div",{className:"calendar-view-day",children:Object(V.a)(e.date,"EEEE")}),Object(I.jsx)("div",{className:"calendar-view-month text-muted",children:Object(V.a)(e.date,"MMMM, yyyy")})]})}function ne(e){var t=(new Date).getDay()===e.date.getDay()?"table-warning":"";return e.events.length<=0?Object(I.jsxs)("tr",{className:t,children:[Object(I.jsx)(ae,Object(d.a)({},e)),Object(I.jsx)("td",{}),Object(I.jsx)("td",{})]}):Object(I.jsx)(r.a.Fragment,{children:e.events.map((function(a,n){var r,c,i,s;return Object(I.jsxs)("tr",{className:t,children:[0===n&&Object(I.jsx)(ae,Object(d.a)({},e)),Object(I.jsx)("td",{className:"calendar-view-timespan",children:Object(I.jsxs)("div",{children:[te(null===(r=a.start)||void 0===r?void 0:r.dateTime,e.timeFormat)," - ",te(null===(c=a.end)||void 0===c?void 0:c.dateTime,e.timeFormat)]})}),Object(I.jsxs)("td",{children:[Object(I.jsx)("div",{className:"calendar-view-subject",children:a.subject}),Object(I.jsx)("div",{className:"calendar-view-organizer",children:null===(i=a.organizer)||void 0===i||null===(s=i.emailAddress)||void 0===s?void 0:s.name})]})]},a.id)}))})}a(162);function re(e){var t,a,r,c,i,s,o,l=L(),d=Object(n.useState)(),j=Object(x.a)(d,2),b=j[0],v=j[1];Object(n.useEffect)((function(){(function(){var e=Object(h.a)(O.a.mark((function e(){var t,a,n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!l.user||b){e.next=12;break}return e.prev=1,a=Object(R.a)(null===(t=l.user)||void 0===t?void 0:t.timeZone),e.next=5,T(l.authProvider,a[0].valueOf());case 5:n=e.sent,v(n),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),l.displayError(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}})()()}));var p=Object(y.a)(new Date),f=Object(w.a)(p);return Object(I.jsxs)(m.a,{children:[Object(I.jsxs)("div",{className:"mb-3",children:[Object(I.jsxs)("h1",{className:"mb-3",children:[Object(V.a)(p,"MMMM d, yyyy")," - ",Object(V.a)(f,"MMMM d, yyyy")]}),Object(I.jsx)(u.b,{to:"/newevent",className:"btn btn-light btn-sm",exact:!0,children:"New event"})]}),Object(I.jsx)("div",{className:"calendar-week",children:Object(I.jsx)("div",{className:"table-responsive",children:b&&Object(I.jsxs)(Q.a,{size:"sm",children:[Object(I.jsx)("thead",{children:Object(I.jsxs)("tr",{children:[Object(I.jsx)("th",{children:"Date"}),Object(I.jsx)("th",{children:"Time"}),Object(I.jsx)("th",{children:"Event"})]})}),Object(I.jsxs)("tbody",{children:[Object(I.jsx)(ne,{date:p,timeFormat:null===(t=l.user)||void 0===t?void 0:t.timeFormat,events:b.filter((function(e){var t;return 0===Object(X.a)(Object(Y.a)(null===(t=e.start)||void 0===t?void 0:t.dateTime))}))}),Object(I.jsx)(ne,{date:Object($.a)(p,{days:1}),timeFormat:null===(a=l.user)||void 0===a?void 0:a.timeFormat,events:b.filter((function(e){var t;return 1===Object(X.a)(Object(Y.a)(null===(t=e.start)||void 0===t?void 0:t.dateTime))}))}),Object(I.jsx)(ne,{date:Object($.a)(p,{days:2}),timeFormat:null===(r=l.user)||void 0===r?void 0:r.timeFormat,events:b.filter((function(e){var t;return 2===Object(X.a)(Object(Y.a)(null===(t=e.start)||void 0===t?void 0:t.dateTime))}))}),Object(I.jsx)(ne,{date:Object($.a)(p,{days:3}),timeFormat:null===(c=l.user)||void 0===c?void 0:c.timeFormat,events:b.filter((function(e){var t;return 3===Object(X.a)(Object(Y.a)(null===(t=e.start)||void 0===t?void 0:t.dateTime))}))}),Object(I.jsx)(ne,{date:Object($.a)(p,{days:4}),timeFormat:null===(i=l.user)||void 0===i?void 0:i.timeFormat,events:b.filter((function(e){var t;return 4===Object(X.a)(Object(Y.a)(null===(t=e.start)||void 0===t?void 0:t.dateTime))}))}),Object(I.jsx)(ne,{date:Object($.a)(p,{days:5}),timeFormat:null===(s=l.user)||void 0===s?void 0:s.timeFormat,events:b.filter((function(e){var t;return 5===Object(X.a)(Object(Y.a)(null===(t=e.start)||void 0===t?void 0:t.dateTime))}))}),Object(I.jsx)(ne,{date:Object($.a)(p,{days:6}),timeFormat:null===(o=l.user)||void 0===o?void 0:o.timeFormat,events:b.filter((function(e){var t;return 6===Object(X.a)(Object(Y.a)(null===(t=e.start)||void 0===t?void 0:t.dateTime))}))})]})]})})})]})}var ce=a(178),ie=a(177),se=a(134);function oe(e){var t=L(),a=Object(n.useState)(""),r=Object(x.a)(a,2),c=r[0],i=r[1],s=Object(n.useState)(""),o=Object(x.a)(s,2),l=o[0],d=o[1],b=Object(n.useState)(""),m=Object(x.a)(b,2),v=m[0],p=m[1],f=Object(n.useState)(""),g=Object(x.a)(f,2),y=g[0],w=g[1],N=Object(n.useState)(""),C=Object(x.a)(N,2),k=C[0],S=C[1],F=Object(n.useState)(!0),T=Object(x.a)(F,2),E=T[0],P=T[1],M=Object(n.useState)(!1),D=Object(x.a)(M,2),Z=D[0],z=D[1];Object(n.useEffect)((function(){P(0===c.length||0===v.length||0===y.length)}),[c,v,y]);var G=function(){var e=Object(h.a)(O.a.mark((function e(){var a,n,r,i,s;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.split(";"),i=[],r.forEach((function(e){e.length>0&&i.push({emailAddress:{address:e}})})),s={subject:c,attendees:i.length>0?i:void 0,start:{dateTime:v,timeZone:null===(a=t.user)||void 0===a?void 0:a.timeZone},end:{dateTime:y,timeZone:null===(n=t.user)||void 0===n?void 0:n.timeZone},body:k.length>0?{contentType:"text",content:k}:void 0},e.prev=4,e.next=7,A(t.authProvider,s);case 7:z(!0),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),t.displayError("Error creating event",JSON.stringify(e.t0));case 13:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(){return e.apply(this,arguments)}}();return Z?Object(I.jsx)(j.a,{to:"/calendar"}):Object(I.jsxs)(ce.a,{children:[Object(I.jsxs)(ce.a.Group,{children:[Object(I.jsx)(ce.a.Label,{children:"Subject"}),Object(I.jsx)(ce.a.Control,{type:"text",name:"subject",id:"subject",className:"mb-2",value:c,onChange:function(e){return i(e.target.value)}})]}),Object(I.jsxs)(ce.a.Group,{children:[Object(I.jsx)(ce.a.Label,{children:"Attendees"}),Object(I.jsx)(ce.a.Control,{type:"text",name:"attendees",id:"attendees",className:"mb-2",placeholder:"Enter a list of email addresses, seperated by a semi-colon",value:l,onChange:function(e){return d(e.target.value)}})]}),Object(I.jsxs)(ie.a,{className:"mb-2",children:[Object(I.jsx)(se.a,{children:Object(I.jsxs)(ce.a.Group,{children:[Object(I.jsx)(ce.a.Label,{children:"Start"}),Object(I.jsx)(ce.a.Control,{type:"datetime-local",name:"start",id:"start",value:v,onChange:function(e){return p(e.target.value)}})]})}),Object(I.jsx)(se.a,{children:Object(I.jsxs)(ce.a.Group,{children:[Object(I.jsx)(ce.a.Label,{children:"End"}),Object(I.jsx)(ce.a.Control,{type:"datetime-local",name:"end",id:"end",value:y,onChange:function(e){return w(e.target.value)}})]})})]}),Object(I.jsxs)(ce.a.Group,{children:[Object(I.jsx)(ce.a.Label,{children:"Body"}),Object(I.jsx)(ce.a.Control,{as:"textarea",name:"body",id:"body",className:"mb-3",style:{height:"10em"},value:k,onChange:function(e){return S(e.target.value)}})]}),Object(I.jsx)(H.a,{color:"primary",className:"me-2",disabled:E,onClick:function(){return G()},children:"Create"}),Object(I.jsx)(u.b,{to:"/calendar",className:"btn btn-secondary",exact:!0,children:"Cancel"})]})}a(163);function le(e){var t=e.pca;return Object(I.jsx)(m.b,{instance:t,children:Object(I.jsx)(D,{children:Object(I.jsxs)(u.a,{children:[Object(I.jsx)(q,{}),Object(I.jsxs)(b.a,{children:[Object(I.jsx)(z,{}),Object(I.jsx)(j.b,{exact:!0,path:"/",render:function(e){return Object(I.jsx)(K,Object(d.a)({},e))}}),Object(I.jsx)(j.b,{exact:!0,path:"/calendar",render:function(e){return Object(I.jsx)(re,Object(d.a)({},e))}}),Object(I.jsx)(j.b,{exact:!0,path:"/newevent",render:function(e){return Object(I.jsx)(oe,Object(d.a)({},e))}})]})]})})})}var de=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,184)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,c=t.getLCP,i=t.getTTFB;a(e),n(e),r(e),c(e),i(e)}))},ue=new s.a({auth:{clientId:l.appId,redirectUri:l.redirectUri},cache:{cacheLocation:"sessionStorage",storeAuthStateInCookie:!0}}),je=ue.getAllAccounts();je&&je.length>0&&ue.setActiveAccount(je[0]),ue.addEventCallback((function(e){if(e.eventType===o.a.LOGIN_SUCCESS&&e.payload){var t=e.payload;ue.setActiveAccount(t.account)}})),i.a.render(Object(I.jsx)(r.a.StrictMode,{children:Object(I.jsx)(le,{pca:ue})}),document.getElementById("root")),de()}},[[164,1,2]]]);
//# sourceMappingURL=main.e0419d2c.chunk.js.map